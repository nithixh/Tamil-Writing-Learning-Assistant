{% extends 'layout.html' %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="page-header">
        <h1>Dashboard</h1>
        <p>Welcome back, <strong>{{ username }}</strong>! Let's continue your learning journey.</p>
    </div>

    <!-- Stats Cards -->
    <div class="row g-4 mb-5">
        <div class="col-md-4">
            <div class="stat-card">
                <div class="stat-icon icon-completed">
                    <i class="fas fa-check"></i>
                </div>
                <div class="stat-info">
                    <span class="stat-value">{{ completed_lessons }} / {{ total_lessons }}</span>
                    <span class="stat-label">Lessons Completed</span>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="stat-card">
                <div class="stat-icon icon-accuracy">
                    <i class="fas fa-bullseye"></i>
                </div>
                <div class="stat-info">
                    <span class="stat-value">{{ avg_accuracy }}%</span>
                    <span class="stat-label">Average Accuracy</span>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="stat-card">
                 <div class="stat-icon icon-progress">
                    <i class="fas fa-tasks"></i>
                </div>
                <div class="stat-info">
                    <span class="stat-value">{{ "%d"|format((completed_lessons / total_lessons * 100) if total_lessons > 0 else 0) }}%</span>
                    <span class="stat-label">Overall Progress</span>
                </div>
            </div>
        </div>
    </div>

    <!-- New Feature: Recommended Practice -->
    <div class="page-header">
        <h2>Recommended Practice</h2>
        <p>Focus on these lessons to improve your skills where it matters most.</p>
    </div>

    <div class="list-group practice-list">
        {% for lesson in difficult_lessons %}
            <a href="/lesson/{{ lesson.id }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                <div>
                    <h5 class="mb-1">{{ lesson.title }} - <span class="tamil-char">{{ lesson.content }}</span></h5>
                    <small>Your best score on this lesson is low. Give it another try!</small>
                </div>
                <span class="badge bg-warning rounded-pill fs-6">Best: {{ "%.0f"|format(lesson.highest_accuracy * 100) }}%</span>
            </a>
        {% else %}
            <div class="list-group-item text-center p-4">
                <i class="fas fa-award fa-2x text-success mb-2"></i>
                <h5 class="mb-1">No specific lessons to practice!</h5>
                <p class="mb-0">You're doing great. Continue with the next lesson.</p>
            </div>
        {% endfor %}
    </div>

</div>
{% endblock %}
